(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{898:function(e,t,r){"use strict";var a=r(385),n=r(270),o=r(38),l=r(12),i=r(89),c=r(16),s=r(156),u=r(69),f=r(82),p=r(21),d=r(134),h=r(47),m=r(1),y=r.n(m),b=r(23),g=r(105);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t,r){return t&&E(e.prototype,t),r&&E(e,r),e}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}function D(e,t){return(D=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function C(e){var t=V();return function r(){var a=j(e),n;if(t){var o=j(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return P(this,n)}}function P(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?F(e):t}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var x=h.a.Row,R=h.a.Col,k=function(e){O(r,e);var t=C(r);function r(e){var a;S(this,r),(a=t.call(this,e)).componentWillUnmount=function(){a.mounted=!1},a.arrayIsEqual=function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1){var a=JSON.stringify(e[r]),n=JSON.stringify(t[r]);if(0!==a.localeCompare(n))return!1}return!0},a.refreshTableData=function(e){a.props.refreshTableData(e)},a.getCluster=function(){var e=[{value:"-1",label:"ALL"}];b.a.get("/monitor/cluster").then((function(t){if(200===t.data.code){var r=t.data.data[0].id,n=t.data.data[0].name,o=a.state.clusterValue;t.data.data.forEach((function(t){t.id<r&&(r=t.id,n=t.name),e.push({value:t.id,label:t.name})}));var l=Object(g.a)(a.props.id).id;if(null!=l?a.props.refreshDataSource(l):a.props.refreshDataSource(r),void 0===o&&"settingUser"!==a.props.id&&"settingTeam"!==a.props.id){var i={id:r,cluster:n,isAll:!1};Object(g.d)(a.props.id,i),o=n}a.setState({clusterSelectData:e,clusterValue:o})}})).catch((function(e){console.error("error",e),void 0!==e.response&&void 0!==e.response.status&&""!==e.response.status&&null!=e.response.status&&null!=e.response.status&&(401===e.response.status?p.a.error({content:"Please login!",closeable:!0}):p.a.error({content:"get cluster faily!",duration:1e4,closeable:!0}))}))},a.handleClusterFilterChange=function(e,t){a.props.refreshDataSource(t.value);var r=a.state.dataSource;e=t.label.toString();var n={id:t.value,cluster:t.label,isAll:!1};"-1"===t.value&&(n.isAll=!0),Object(g.d)(a.props.id,n);var o=a.filterByPara(r,a.state.clusterField,e,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue);a.setState({clusterValue:e}),a.refreshTableData(o)},a.handleFilterChange=function(e){e=e.toString();var t=a.state.dataSource,r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,e,a.state.switchField,a.state.switchValue);a.setState({searchValue:e}),a.refreshTableData(r),a.setSesion("".concat(a.props.id,"Search"),e)},a.onSwitchChange=function(e){var t=a.state.dataSource,r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,e);a.setState({switchValue:e}),a.refreshTableData(r),a.setSesion("".concat(a.props.id,"Switch"),e)},a.setSesion=function(e,t){void 0!==e&&sessionStorage.setItem(e,t)},a.initData=function(e){var t=JSON.parse(JSON.stringify(e)),r=a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue);a.setState({dataSource:t}),a.refreshTableData(r)},a.filterByPara=function(e,t,r,n,o,l,i){var c=JSON.parse(JSON.stringify(e));return a.isNullOrEmptyStr(l)||i&&"false"!==i||(c=c.filter((function(e){return!e[l].startsWith("_")}))),a.isNullOrEmptyStr(r)||"ALL"===r||(c=a.searchdata(c,t,r)),a.isNullOrEmptyStr(o)||(c=a.searchdata(c,n,o)),c},a.searchdata=function(e,t,r){var a=t.split(",");return e.filter((function(e){for(var t=!1,n=0,o=a.length;n<o;n+=1){for(var l=a[n].split("."),i=e,c=0,s=l.length;c<s;c+=1)i=i[l[c]];if(-1!==i.toLocaleLowerCase().search(r.toLocaleLowerCase())){t=!0;break}}return t}))},a.isNullOrEmptyStr=function(e){return null==e||""===e},a.selectView=function(e){return y.a.createElement(R,{align:"center"},y.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),y.a.createElement(u.a,{showSearch:!0,dataSource:a.state.clusterSelectData,placeholder:"please select cluster",style:{width:"300px"},onChange:function e(t,r,n){a.handleClusterFilterChange(t,n)},value:a.state.clusterValue}))},a.filterView=function(e,t){return y.a.createElement(R,{align:"center"},y.a.createElement("span",{style:{fontWeight:"600"}},e,":\xa0\xa0\xa0"),y.a.createElement(c.a,{placeholder:a.isNullOrEmptyStr(t)?"Input filter value":t,hasClear:!0,onChange:a.handleFilterChange,style:{width:"300px"},value:a.state.searchValue}))},a.parseBoolean=function(e){return"true"===e||"TRUE"===e||"True"===e||"false"!==e&&"FALSE"!==e&&"False"!==e&&void 0},a.getFilterData=function(e){var t=JSON.parse(JSON.stringify(e)),r;return a.filterByPara(t,a.state.clusterField,a.state.clusterValue,a.state.searchField,a.state.searchValue,a.state.switchField,a.state.switchValue)},a.switchView=function(){var e=a.state.switchValue;return"string"==typeof a.state.switchValue&&(e=a.parseBoolean(a.state.switchValue.trim())),y.a.createElement(R,{align:"center"},y.a.createElement("div",{style:{display:"flex"}},y.a.createElement("span",{style:U.special},"Include special topic:\xa0\xa0"),y.a.createElement(n.a,{onChange:a.onSwitchChange,checked:e,defaultChecked:e,checkedChildren:y.a.createElement(l.a,{type:"select",size:"xs"}),unCheckedChildren:y.a.createElement(l.a,{type:"close",size:"xs"})})))},void 0!==a.props.onRef&&a.props.onRef(F(a));var o=sessionStorage.getItem("".concat(a.props.id,"Search")),i=sessionStorage.getItem("".concat(a.props.id,"Switch"));return a.state={dataSource:a.props.dataSource,clusterSelectData:[],clusterValue:Object(g.a)(a.props.id).cluster,clusterField:a.props.selectField,searchValue:null===o?"":o,searchField:a.props.searchField,switchField:a.props.switchField,switchValue:null!==i&&i},a}return w(r,[{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"componentDidMount",value:function e(){this.getCluster()}},{key:"componentWillReceiveProps",value:function e(t){this.validateCondition(this.state.dataSource,t.dataSource)&&(this.setState({dataSource:t.dataSource}),this.initData(t.dataSource))}},{key:"validateCondition",value:function e(t,r){return(null!=t||null!=r)&&((void 0!==t||void 0!==r)&&((0!==t.length||0!==r.length)&&(!this.arrayIsEqual(t,r)&&t!==r)))}},{key:"render",value:function e(){var t=this.props.selectTitle,r=this.props.searchTitle,a=this.props.searchPlaceholder,n=this.isNullOrEmptyStr(t)?"":this.selectView(t),o=this.isNullOrEmptyStr(r)?"":this.filterView(r,a),l=this.isNullOrEmptyStr(this.props.otherComponent)?"":this.props.otherComponent,i=this.isNullOrEmptyStr(this.props.switchField)?"":this.switchView();return y.a.createElement(x,{style:U.row},n,o,l,i)}}]),r}(m.Component),U={row:{margin:"20px 4px 20px"},special:{fontFamily:'Roboto, "Helvetica Neue", Helvetica, Tahoma, Arial, "PingFang SC", "Microsoft YaHei"',fontSize:"12px",lineHeight:"1.28571",color:"#333333",alignSelf:"center",fontWeight:"600"}},_=t.a=k},982:function(e,t,r){"use strict";r.r(t);var a=r(1),n=r.n(a),o=r(68),l=r.n(o),i=r(158),c=r(200),s=r(22),u=r(62),f=r(20),p=r(89),d=r(16),h=r(156),m=r(69),y=r(38),b=r(12),g=r(157),v=r(83),S=r(82),E=r(21),w=r(134),O=r(47),D=r(269),C=r(898),P=r(384),F=r(13),V=r(23);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t,r){return t&&_(e.prototype,t),r&&_(e,r),e}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function N(e){var t=M();return function r(){var a=J(e),n;if(t){var o=J(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return B(this,n)}}function B(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?L(e):t}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var W=O.a.Row,z=O.a.Col,H=function(e){T(r,e);var t=N(r);function r(){var e;U(this,r);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).chanageSelect=function(t,r){""===t?E.a.error("Please select role"):v.a.confirm({title:"Update User Role",content:"Update permissions for ".concat(r.name," : [").concat(t,"]"),onOk:function a(){return e.updateUserRole(r.id,t)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.state={isLoading:!1,dataSource:[],selected:"",pageData:[],filterDataSource:[],oauthEnable:!1,formValue:{},addUserVisable:!1,title:"Add User"},e.componentWillUnmount=function(){e.mounted=!1},e.handleDelete=function(t){v.a.confirm({title:"Delete User",content:"confirm delete this user: ".concat(t.name,"?"),onOk:function r(){return e.deleteUser(t.id)},okProps:{children:"OK"},cancelProps:{children:"Cancel"}})},e.deleteUser=function(t){V.a.delete("/users/del/".concat(t)).then((function(t){200===t.data.code?(E.a.success("Delete success"),e.fetchData()):E.a.error(t.data.message)})).catch((function(e){console.error(e)}))},e.updateUserRole=function(t,r){V.a.put("users/role",{id:t,role:r}).then((function(t){200===t.data.code?(E.a.success("Update role success"),e.fetchData()):E.a.error(t.data.message)})).catch((function(e){console.error(e)}))},e.fetchData=function(){e.setState({isLoading:!0},(function(){V.a.get("/users").then((function(t){if(200===t.data.code){if(e.mounted){var r=Object(P.d)(t.data.data,"name");e.setState({dataSource:r,isLoading:!1,filterDataSource:r})}}else E.a.error(t.data.message)})).catch((function(e){console.error(e)}))}))},e.refreshTableData=function(t){e.setState({filterDataSource:t})},e.redrawPageData=function(t){e.setState({pageData:t})},e.validateAllFormField=function(){e.form.validateAll((function(t,r){t||V.a.post("users/register",r).then((function(t){200===t.data.code?(E.a.success(t.data.message),e.changeUserVisable(),e.fetchData()):E.a.error(t.data.message)})).catch((function(e){console.error(e)}))}))},e.validateEmail=function(e,t,r){var a;return/^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(t)?r():r(new Error("email address is invaild,please check!"))},e.onCancel=function(){e.changeUserVisable()},e.addUser=function(){e.setState({formValue:{}}),e.changeUserVisable()},e.changeUserVisable=function(){e.setState({addUserVisable:!e.state.addUserVisable})},e.renderOper=function(t,r,a){return n.a.createElement("div",{style:q.oper},n.a.createElement("span",{title:"Delete",style:q.operBtn},n.a.createElement(b.a,{size:"xxs",type:"close",onClick:function t(){e.handleDelete(a)}})))},e.renderRole=function(t,r,a){var o=m.a.Option;return n.a.createElement("span",{title:"Role"},n.a.createElement(m.a,{id:"basic-demo",value:a.role,defaultValue:"",onChange:function t(r){return e.chanageSelect(r,a)},showSearch:!0},n.a.createElement(o,{value:"ADMIN"},"Admin"),n.a.createElement(o,{value:"MEMBER"},"Member")))},e.addUserView=function(){var t=e.state.isMobile,r=m.a.Option,a=R({},q.simpleFormDialog);t&&(a.width="300px");var o={children:"OK"},l={children:"Cancel"};return n.a.createElement(v.a,{visible:e.state.addUserVisable,className:"simple-form-dialog",onOk:e.validateAllFormField,onCancel:e.onCancel,footerAlign:"center",isFullScreen:!0,onClose:e.onCancel,style:a,title:e.state.title,okProps:o,cancelProps:l},n.a.createElement(F.FormBinderWrapper,{ref:function t(r){e.form=r},value:e.state.formValue,onChange:e.onFormChange},n.a.createElement("div",{style:q.formContent},n.a.createElement(W,{style:q.formItem},n.a.createElement(z,{span:"".concat("6"),style:q.label},"User Name:"),n.a.createElement(z,{span:"".concat(t?"18":"16")},n.a.createElement(F.FormBinder,{name:"name",required:!0},n.a.createElement(d.a,{style:q.inputItem,placeholder:"User name"})),n.a.createElement(F.FormError,{name:"name"}))),n.a.createElement(W,{style:q.formItem},n.a.createElement(z,{span:"".concat("6"),style:q.label},"Email:"),n.a.createElement(z,{span:"".concat(t?"18":"16")},n.a.createElement(F.FormBinder,{name:"email",required:!0,triggerType:"onBlur",validator:e.validateEmail},n.a.createElement(d.a,{style:q.inputItem,placeholder:""})),n.a.createElement(F.FormError,{name:"email"}))),n.a.createElement(W,{style:q.formItem},n.a.createElement(z,{span:"".concat("6"),style:q.label},"Role:"),n.a.createElement(z,{span:"".concat(t?"18":"16")},n.a.createElement(F.FormBinder,{name:"role",required:!0,triggerType:"onBlur"},n.a.createElement(m.a,{id:"basic-demo",defaultValue:"",style:q.inputItem},n.a.createElement(r,{value:"ADMIN"},"Admin"),n.a.createElement(r,{value:"MEMBER"},"Member"))),n.a.createElement(F.FormError,{name:"role"}))),n.a.createElement(W,{style:q.formItem},n.a.createElement(z,{span:"".concat("6"),style:q.label},"Password:"),n.a.createElement(z,{span:"".concat(t?"18":"16")},n.a.createElement("span",null,"123456"))))))},e}return I(r,[{key:"componentDidMount",value:function e(){}},{key:"componentWillMount",value:function e(){this.mounted=!0}},{key:"onSort",value:function e(t,r){var a=Object(P.e)(this.state.filterDataSource,t,r);this.refreshTableData(a)}},{key:"render",value:function e(){var t=this,r=this.state.isLoading,a=n.a.createElement(z,{align:"center"},n.a.createElement(f.a,{type:"secondary",onClick:this.addUser},n.a.createElement(b.a,{type:"add"}),"Add User"));return n.a.createElement("div",null,n.a.createElement(C.a,{dataSource:this.state.dataSource,refreshTableData:this.refreshTableData,refreshDataSource:this.fetchData,searchTitle:"Filter",searchField:"name",searchPlaceholder:"Input User Name",otherComponent:a,id:"settingUser"}),n.a.createElement(s.a,{loading:r,dataSource:this.state.pageData,hasBorder:!1,onSort:function e(r,a){return t.onSort(r,a)},primaryKey:"id"},n.a.createElement(s.a.Column,{title:"Name",dataIndex:"name",sortable:!0}),n.a.createElement(s.a.Column,{title:"Email",dataIndex:"email"}),n.a.createElement(s.a.Column,{title:"Role",dataIndex:"role",cell:this.renderRole}),n.a.createElement(s.a.Column,{title:"Operation",cell:this.renderOper})),n.a.createElement(D.a,{dataSource:this.state.filterDataSource,redrawPageData:this.redrawPageData}),this.addUserView())}}]),r}(a.Component),q={operBtn:{display:"inline-block",width:"24px",height:"24px",borderRadius:"999px",color:"#929292",background:"#f2f2f2",textAlign:"center",cursor:"pointer",lineHeight:"24px",marginRight:"6px"},formContent:{alignItems:"center"},formItems:{alignItems:"center",marginTop:0},formItemes:{alignItems:"center",float:"right",marginTop:0},formItem:{alignItems:"center",position:"relative",marginTop:20},inputItem:{width:"100%"},simpleFormDialog:{width:"640px"},label:{textAlign:"left",paddingLeft:"5%",lineHeight:"26px"}};function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function $(e,t,r){return t&&Y(e.prototype,t),r&&Y(e,r),e}function G(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}function Q(e,t){return(Q=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function X(e){var t=re();return function r(){var a=ae(e),n;if(t){var o=ae(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return ee(this,n)}}function ee(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?te(e):t}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var ne=function(e){G(r,e);var t=X(r);function r(){return K(this,r),t.apply(this,arguments)}return $(r,[{key:"render",value:function e(){var t=[{link:"",text:"Setting"},{link:"",text:"User"}];return n.a.createElement("div",null,n.a.createElement(i.a,{items:t,title:"User"}),n.a.createElement(l.a,{style:oe.container},n.a.createElement(H,null)))}}]),r}(a.Component),oe={container:{margin:"20px",padding:"10px 20px 20px",minHeight:"600px"}},le=t.default=ne}}]);