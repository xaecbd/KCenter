(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{936:function(e,t,r){"use strict";r.r(t);var n=r(924),a=r(935),o=r(900),s=r(901),i=r(62),l=r(20),c=r(38),u=r(12),p=r(89),m=r(16),f=r(82),y=r(21),d=r(134),h=r(47),w=r(1),S=r.n(w),g=r(68),v=r.n(g),b=r(925),E=r.n(b),_=r(931),P=r(932),k=r(25),q=r(933),x=r.n(q),C=r(934),A,O;function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function R(e){return z(e)||V(e)||N(e)||M()}function M(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}function V(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function z(e){if(Array.isArray(e))return T(e)}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t,r){return t&&I(e.prototype,t),r&&I(e,r),e}function W(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}function D(e,t){return(D=Object.setPrototypeOf||function e(t,r){return t.__proto__=r,t})(e,t)}function $(e){var t=Q();return function r(){var n=U(e),a;if(t){var o=U(this).constructor;a=Reflect.construct(n,arguments,o)}else a=n.apply(this,arguments);return H(this,a)}}function H(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?G(e):t}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var B=h.a.Row,F=h.a.Col,K=Object(k.withRouter)(A=O=function(e){W(r,e);var t=$(r);function r(){var e;J(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={id:"".concat(e.props.match.params.clusterName,"|").concat(e.props.match.params.ksqlServerId),consoleValue:"",runStatus:!0,stopStatus:!0,queryPropertiesStatus:!1,queryProperties:new Map,queryPropertiesShow:[],queryPropertiesShowMap:new Map,results:[],schema:[],jsonView:null,mounted:!0},e.ws=new WebSocket(window.location.host.indexOf("3333")>0?"ws://127.0.0.1:8080/ksql_console":"http:"===window.location.protocol?"ws://".concat(window.location.host,"/ksql_console"):"wss://".concat(window.location.host,"/ksql_console")),e.customAceEditorCompleter={getCompletions:function e(t,r,n,a,o){var s;o(null,[].concat(R(["create","create stream","create stream as select","create table","create table as select","drop stream","drop table","as","select","left","full","inner","join","window","windowstart","where","rowkey","group","by","having","and","emit","changes","type","stream","with","drop","table","show","types","insert","into","values","describe","extended","function","explain","if","exists","delete","topic","print","from","beginning","interval","limit","rowtime","set","cast","kafka_topic","case","when","then","else","end","like","between","list","functions","topics","streams","tables","queries","properties","spool","terminate","struct","abs","arraycontains","as_array","as_map","ceil","concat","unix_date","unix_timestamp","datetostring","elt","entries","extractjsonfield","exp","field","floor","generate_series","generate_series","geo_distance","ifnull","initcap","lcase","len","ln","mask","mask_keep_left","mask_keep_right","mask_left","mask_right","random","replace","round","sign","sqrt","slice","split","stringtodate","stringtotimestamp","substring","timestamptostring","trim","ucase","url_decode_param","url_encode_param","url_extract_fragment","url_extract_host","url_extract_parameter","url_extract_path","url_extract_port","url_extract_protocol","url_extract_query","collect_list","collect_set","count","histogram","average","max","min","sum","topk","topkdistinct","windowstart","windowend","explode","value_format","partition","partitions","replicas","value_delimiter","key","timestamp","timestamp_format","wrap_single_value","window_type","window_size","kafka_ceter is best."].map((function(e){return{caption:e,value:e,meta:"static"}}))),R(r.$mode.$highlightRules.$keywordList.map((function(e){return{caption:e,value:e,meta:"keyword"}})))))}},e.onChange=function(t){e.setState({consoleValue:t})},e.onRun=function(){var t=e.state.consoleValue;if(null==t||0===t.trim().length)y.a.error("can not be empty!");else{e.setState({results:[],jsonView:null});var r="ksql",n;t.toLowerCase().startsWith("select")&&(r="query");var a=e.state.queryProperties,o={};a.forEach((function(e){null!=e.n&&e.n.trim().length>0&&null!=e.v&&e.v.trim().length>0&&(o[e.n]=e.v)})),t.endsWith(";")||(t+=";");var s={id:e.state.id,message:JSON.stringify({ksql:t,streamsProperties:o}),operate:"run",type:r};e.ws.send(JSON.stringify(s)),e.setState({runStatus:!0,stopStatus:!1})}},e.onStop=function(){var t={id:e.state.id,message:"",operate:"stop"};e.ws.send(JSON.stringify(t)),e.setState({runStatus:!1,stopStatus:!0})},e.onAddQueryProperties=function(){if(0===e.state.queryPropertiesShow.length){var t=S.a.createElement("div",{key:0},S.a.createElement(B,null,"\xa0"),S.a.createElement(B,null,S.a.createElement(F,null," ",S.a.createElement(m.a,{defaultValue:"auto.offset.reset",onChange:e.onPropertiesChange,name:"0n"}),"\xa0=\xa0",S.a.createElement(m.a,{defaultValue:"latest",onChange:e.onPropertiesChange,name:"0v"}),"\xa0\xa0 ",S.a.createElement(l.a,{primary:"true",text:!0,onClick:function t(){return e.onRemoveProperties(0)}},S.a.createElement(u.a,{type:"ashbin"})," ")))),r=new Map;r.set(0,t);var n=e.state.queryProperties;n.set("0",{n:"auto.offset.reset",v:"latest"}),e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus,queryPropertiesShow:[t],queryPropertiesShowMap:r,queryProperties:n})}else e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus})},e.onRemoveProperties=function(t){t=t?Number(t.index):0;var r=e.state.queryPropertiesShowMap,n=e.state.queryProperties;n.delete("".concat(t)),r.delete(t);var a=[];r.forEach((function(e){a.push(e)})),0===r.size&&e.setState({queryPropertiesStatus:!e.state.queryPropertiesStatus}),e.setState({queryPropertiesShow:a,queryPropertiesShowMap:r,queryProperties:n})},e.onPropertiesChange=function(t,r){var n=r.currentTarget.name,a=n.substring(0,1),o=n.substring(1,2),s=e.state.queryProperties,i=s.get(a)?s.get(a):{};i[o]=t,s.set(a,i),e.setState({queryProperties:s})},e.onAddAnotherProperties=function(){var t=e.state.queryPropertiesShow.length,r=S.a.createElement("div",{key:t},S.a.createElement(B,null,"\xa0"),S.a.createElement(B,null,S.a.createElement(F,null," ",S.a.createElement(m.a,{onChange:e.onPropertiesChange,name:"".concat(t,"n")}),"\xa0=\xa0",S.a.createElement(m.a,{onChange:e.onPropertiesChange,name:"".concat(t,"v")}),"\xa0\xa0 ",S.a.createElement(l.a,{primary:"true",text:!0,onClick:function r(){return e.onRemoveProperties({index:t})}},S.a.createElement(u.a,{type:"ashbin"})," ")))),n=e.state.queryPropertiesShowMap;n.set(t,r),e.setState({queryPropertiesShow:[].concat(R(e.state.queryPropertiesShow),[r]),queryPropertiesShowMap:n})},e}return L(r,[{key:"componentDidMount",value:function e(){var t=this;this.ws.onopen=function(){t.setState({runStatus:!1,stopStatus:!0})},this.ws.onclose=function(){t.state.mounted&&t.setState({runStatus:!0,stopStatus:!0})},this.ws.onmessage=function(e){if(t.state.mounted)try{var r=t.state.consoleValue.toLowerCase(),n=JSON.parse(e.data);if(r.startsWith("select")||n.errorMessage)if(0===t.state.schema.length){for(var a,o=n.header.schema.split(","),s=[],i=0;i<o.length;i+=1){var l=o[i].substring(o[i].indexOf("`")+1,o[i].lastIndexOf("`"));s=[].concat(R(s),[l])}t.setState({schema:s})}else try{for(var c=n.row.columns,u=t.state.schema,p={},m=0;m<u.length;m+=1)p[u[m]]=c[m];var f=[p].concat(R(t.state.results));t.setState({results:f})}catch(r){var y=S.a.createElement(x.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:y}),console.warn(r)}else{var d=S.a.createElement(x.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:d,runStatus:!1,stopStatus:!0})}}catch(r){var h=S.a.createElement(x.a,{id:"json-pretty",data:e.data,keyStyle:"color:#008080;font-size:1.5em",valueStyle:"color:#0f1e78;font-size:1.5em"});t.setState({jsonView:h,runStatus:!1,stopStatus:!0}),t.onStop(),console.error(r)}}}},{key:"componentWillUnmount",value:function e(){var t={id:this.state.id,message:"",operate:"stop"};this.setState({mounted:!1}),this.ws.send(JSON.stringify(t))}},{key:"render",value:function e(){var t=this.state,r=t.results,n=t.jsonView,o=S.a.createElement("div",{style:X.messageStyle},S.a.createElement("h1",null,"No new messages"),"The message browser shows messages that have arrived since this page was opened.");return S.a.createElement(v.a,null,S.a.createElement(s.a,{className:"free-card custom",free:!0},S.a.createElement("div",{className:"free-card-main"},S.a.createElement(s.a.Content,null,S.a.createElement(B,null,S.a.createElement(F,{span:"24"},S.a.createElement(E.a,{placeholder:"Example: SELECT field1, field2, field3 FROM mystream WHERE field1 = \u2018somevalue\u2019 EMIT CHANGES;",mode:"sql",height:"100px",value:this.state.consoleValue,width:"100%",theme:"xcode",name:"blah2",onChange:this.onChange,fontSize:14,showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:[this.customAceEditorCompleter],enableLiveAutocompletion:!0,showLineNumbers:!1,tabSize:2}})))),S.a.createElement(s.a.Actions,null,S.a.createElement(a.a,{dashed:!0}),S.a.createElement(B,null,S.a.createElement(F,{span:"12"},S.a.createElement(B,null,S.a.createElement(l.a,{text:!0,onClick:this.onAddQueryProperties,style:{display:"block",color:"blue",textAlign:"left",textDecoration:"underline"}},"Add query properties")),S.a.createElement("div",{style:{display:this.state.queryPropertiesStatus?"":"none"}},this.state.queryPropertiesShow.map((function(e){return e})),S.a.createElement(B,null,"\xa0"),S.a.createElement(B,null,S.a.createElement(l.a,{text:!0,onClick:this.onAddAnotherProperties,style:{display:"block",color:"blue",textAlign:"left",textDecoration:"underline"}},"Add another field")))),S.a.createElement(F,{span:"12"},S.a.createElement("span",{style:{display:this.state.runStatus?"":"none"}},"Running...\xa0\xa0"),S.a.createElement("span",null,S.a.createElement(l.a,{type:"primary",disabled:this.state.runStatus,onClick:this.onRun},"\xa0\xa0 Run\xa0\xa0")," \xa0\xa0",S.a.createElement(l.a,{type:"secondary",disabled:this.state.stopStatus,onClick:this.onStop},"\xa0\xa0Stop\xa0\xa0"))))))),S.a.createElement(s.a,{style:X.resultStyle,className:"free-card custom",free:!0},S.a.createElement("div",{className:"free-card-main"},S.a.createElement(s.a.Content,null,n||r.length>0?null:o,r.map((function(e){return S.a.createElement("p",{key:e.ROWTIME},JSON.stringify(e))})),n))))}}]),r}(w.Component))||A,X={resultStyle:{marginTop:"50px",minHeight:"200px"},messageStyle:{textAlign:"center"}},Y=t.default=K}}]);